@Name("RankingProd")
INSERT INTO RankingProd
SELECT SUM(power) as suma, 
count(systemNumber) as events,
systemNumber,
MAX(time) as time,
SUM(power)/count(systemNumber) as productividad,
fecha
FROM  WindEvent.win:time_batch(6 sec) t
GROUP BY systemNumber,fecha
HAVING count(systemNumber)>0
ORDER BY productividad DESC